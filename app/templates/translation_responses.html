{% extends "base.html" %}
{% block content %}

<div class="subcontainer">

  <h1>{{ _("Response to a Challenge") }} <span style="font-weight:normal">({{ _("Beta") }})</span></h1>

  <div class="table">
    <div class="row-fluid">
      <div class="span3 header">{{ _("Original text") }} ({{ trequest.source | language_name }})</div>
      <div class="span9">{{ trequest.original_text }}</div>
    </div>

    {% if tresponse1 %}
    <div class="row-fluid">
      <div class="span3 header">{{ _("Regular translation") }} ({{ trequest.target | language_name }})</div>
      <div class="span9">
        {{ tresponse1.translated_text }}
        <a href="{{ url_for('index', translation_id=tresponse1.id_b62) }}"><i class="icon-share-alt"></i></a>
      </div>
    </div>
    {% endif %}

    {% if tresponse2 %}
    <div class="row-fluid">
      <div class="span3 header">{{ _("Better translation") }} ({{ trequest.target | language_name }})</div>
      <div class="span9">
        {{ tresponse2.translated_text }}
        <a href="{{ url_for('index', translation_id=tresponse2.id_b62) }}"><i class="icon-share-alt"></i></a>
      </div>
    </div>
    {% endif %}

    <div class="row-fluid">
      <div class="span3"></div>
      <div class="span9">
        <ul class="media-list">
        {% for tresponse in tresponses %}
        {% set mine = tresponse.user_id == current_user.id %}
          <li class="translation-response {% if mine %}highlight{% endif %}">
            <div>
              {{ tresponse.user.name }} &middot;
              {{ tresponse.timestamp | date }} &middot;
              <span class="rating-plus" translation-id="{{ tresponse.id_b62 }}">{{ tresponse.plus_ratings }}</span> /
              <span class="rating-minus" translation-id="{{ tresponse.id_b62 }}">{{ tresponse.minus_ratings }}</span> &nbsp;
              <div class="btn-group">
                <button class="btn btn-mini" translation-id="{{ tresponse.id_b62 }}" rating="1" onclick="rateTranslation($(this))">
                  <i class="icon-plus"></i>
                </button>
                <button class="btn btn-mini" translation-id="{{ tresponse.id_b62 }}" rating="-1" onclick="rateTranslation($(this))">
                  <i class="icon-minus"></i>
                </button>
              </div>
              {% if mine %}&nbsp;
              <a href="{{ url_for('translation_response', request_id=trequest.id_b62) }}">{{ _("Edit") }}</a>
              {% endif %}
            </div>
            <div>{{ tresponse.translated_text }}</div>
          </li>
        {% endfor %}
      </li>
      </div>
    </div>
  </div>

</div>

<script>
{% for rating in ratings %}
  $("button[translation-id={{ rating.translation_id | uuid_to_b62 }}][rating={{ rating.rating }}]").addClass("active");
{% endfor %}
</script>

{% endblock %}